# Gravitational fields in spherical coordinates using Tesseroids with variable density

## Introduction

When computing gravitational fileds on regional or global scales it's necessary to take
into account the curvature of the Earth. One way to do this is using spherical prisms,
also known as Tesseroids.
One common approach to numerically solve the integrals that define the gravitational
fields generated by Tesseroids is to apply a Gauss-Legendre Quadrature (GQL).
Nevertheless, most methodologies consider only Tesseorids with homogeneous density or
with specific density variations in depth, like linear or polynomial.
We propose a new methodology to compute the gravitational fields generated by
Tesseroids with any continuous density variation in depth through GLQ and two
discretization algorithms.

> Imagen del Tesseroid


## Methodology

The gravitational potential generated by a Tesseroid with variable density in depth is
defined by the following integral:

```
\begin{equation}
    V(r,\phi,\lambda) = G
    \int\limits_{\lambda_1}^{\lambda_2}
    \int\limits_{\phi_1}^{\phi_2}
    \int\limits_{r_1}^{r_2}
    \frac{\rho(r')}{\ell} {r'}^2 \cos\phi' \,  dr' d\phi' d\lambda'.
\end{equation}
```

This volume integral can be numerically approximated through a GLQ:

```
\begin{equation}
    \int\limits_{\lambda_1}^{\lambda_2}
    \int\limits_{\phi_1}^{\phi_2}
    \int\limits_{r_1}^{r_2}
        \rho(r') \underbrace{f(r', \phi', \lambda')}_\text{integration kernel}
        dr' d\phi' d\lambda'
    \approx
    A
    \sum\limits_{i=1}^{N^r}
    \sum\limits_{j=1}^{N^\phi}
    \sum\limits_{k=1}^{N^\lambda}
        \underbrace{W_i^r W_j^\phi W_k^\lambda}_\text{GLQ weights}
        \overbrace{\rho(r_i) f(r_i, \phi_j, \lambda_k)}^\text{evaluated on GLQ nodes}
\end{equation}
```

The **GQL is equivalent** to approximate the Tesseroid as **point masses** located on
the nodes of the Quadrature.

> Imagen de GQL nodes

This introduces two sources of errors:
- The approximation gets worst when getting closer to the Tesseroid.
- The density function is only evaluated at two depths.
